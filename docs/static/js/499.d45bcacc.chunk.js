/*! For license information please see 499.d45bcacc.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkbmstu_navigator=self.webpackChunkbmstu_navigator||[]).push([[499,1218],{499:(e,t,o)=>{o.r(t),o.d(t,{default:()=>s});o(1218);const i=()=>{n("svgeditstore")},n=e=>{document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"},r=e=>{e=e?"storagePrompt="+e:"";const t=top.location;t.href.includes("storagePrompt=")?t.href=t.href.replace(/([&?])storagePrompt=[^&]*(&?)/,(function(t,o,i){return(e?o:"")+e+(!e&&i?o:i||"")})):t.href+=(t.href.includes("?")?"&":"?")+e},s={name:"storage",init(){const e=this,{svgCanvas:t,storage:o}=e,{noStorageOnLoad:s,forceStorage:a,canvasName:c}=e.configObj.curConfig;if(o&&(a||!s&&/(?:^|;\s*)svgeditstore=prefsAndContent/.test(document.cookie))){const t="svgedit-"+c,i=o.getItem(t);if(i){var l;e.loadFromString(i);const n=null!==(l=o.getItem("title-".concat(t)))&&void 0!==l?l:"untitled.svg";e.topPanel.updateTitle(n),e.layersPanel.populateLayers()}}const d=document.createElement("se-storage-dialog");d.setAttribute("id","se-storage-dialog"),e.$container.append(d),d.init(e.i18next),d.addEventListener("change",(t=>{var o,s,a;if(d.setAttribute("dialog","close"),"ok"===(null===t||void 0===t||null===(o=t.detail)||void 0===o?void 0:o.trigger))if("noPrefsOrContent"!==(null===t||void 0===t||null===(a=t.detail)||void 0===a?void 0:a.select)){var c;const e=new URL(top.location).searchParams.get("storagePrompt");if(document.cookie="svgeditstore="+encodeURIComponent(t.detail.select)+"; expires=Fri, 31 Dec 9999 23:59:59 GMT","true"===e&&null!==t&&void 0!==t&&null!==(c=t.detail)&&void 0!==c&&c.checkbox)return void r()}else{var l,u,m;if(i(),e.configObj.curConfig.emptyStorageOnDecline&&null!==t&&void 0!==t&&null!==(l=t.detail)&&void 0!==l&&l.checkbox&&(p(""),Object.keys(e.curPrefs).forEach((t=>{t="svg-edit-"+t,e.storage&&e.storage.removeItem(t),n(t)}))),null!==t&&void 0!==t&&null!==(u=t.detail)&&void 0!==u&&u.select&&null!==t&&void 0!==t&&null!==(m=t.detail)&&void 0!==m&&m.checkbox)return void r("false")}else"cancel"===(null===t||void 0===t||null===(s=t.detail)||void 0===s?void 0:s.trigger)&&i();g(),e.storagePromptState="closed",e.updateCanvas(!0)}));const p=t=>{const i="svgedit-".concat(e.configObj.curConfig.canvasName);t?(o.setItem(i,t),o.setItem("title-".concat(i),e.title)):(o.removeItem(i),o.removeItem("".concat(i,"-title")))},g=()=>{window.addEventListener("beforeunload",(function(){if(!/(?:^|;\s*)svgeditstore=(?:prefsAndContent|prefsOnly)/.test(document.cookie))return;/(?:^|;\s*)svgeditstore=prefsAndContent/.test(document.cookie)&&p(t.getSvgString()),e.setConfig({no_save_warning:!0});const{curPrefs:i}=e.configObj;Object.entries(i).forEach((e=>{let[t,i]=e;t="svg-edit-"+t,void 0!==i&&(o?o.setItem(t,i):window.widget?window.widget.setPreferenceForKey(i,t):(i=encodeURIComponent(i),document.cookie=encodeURIComponent(t)+"="+i+"; expires=Fri, 31 Dec 9999 23:59:59 GMT"))}))}))};let u=!1;return{name:"storage",callback(){const t=new URL(top.location).searchParams.get("storagePrompt");if(!u)if(u=!0,a||"true"!==t&&("false"===t||/(?:^|;\s*)svgeditstore=(?:prefsAndContent|prefsOnly)/.test(document.cookie)))s&&!a||g();else{const t=Boolean(o);e.storagePromptState="waiting";const i=document.getElementById("se-storage-dialog");i.setAttribute("dialog","open"),i.setAttribute("storage",t)}}}}}},1218:(e,t,o)=>{o.r(t),o.d(t,{SeStorageDialog:()=>n});const i=document.createElement("template");i.innerHTML='<style>#dialog_content{margin:10px 10px 5px 10px;background:#ddd;overflow:auto;text-align:left;border:1px solid #5a6162}#dialog_content label,#dialog_content p,#dialog_content select{margin:10px;line-height:1.3em}#dialog_container{font-family:Verdana;text-align:center;left:50%;top:50%;max-width:440px;z-index:50001;background:#5a6162;border:1px outset #777;font-family:Verdana,Helvetica,sans-serif;font-size:.8em}#dialog_container,#dialog_content{border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px}#dialog_buttons input[type=text]{width:90%;display:block;margin:0 0 5px 11px}#dialog_buttons input[type=button]{margin:0 1em}</style> <elix-dialog id="dialog_box" aria-label="SVG-Edit storage preferences" closed> <div class="overlay"></div> <div id="dialog_container"> <div id="dialog_content"> <p id="notificationNote"> </p> <select id="se-storage-pref"> <option value="prefsAndContent" id="prefsAndContent"></option> <option value="prefsOnly" id="prefsOnly"></option> <option value="noPrefsOrContent" id="noPrefsOrContent"></option> </select> <label title="" id="se-remember-title"> <input type="checkbox" id="se-remember" value="" checked="checked"> </label> </div> <div id="dialog_buttons"> <button id="storage_ok"></button> <button id="storage_cancel"></button> </div> </div> </elix-dialog>';class n extends HTMLElement{constructor(){super(),this._shadowRoot=this.attachShadow({mode:"open"}),this._shadowRoot.append(i.content.cloneNode(!0)),this.$dialog=this._shadowRoot.querySelector("#dialog_box"),this.$storage=this._shadowRoot.querySelector("#js-storage"),this.$okBtn=this._shadowRoot.querySelector("#storage_ok"),this.$cancelBtn=this._shadowRoot.querySelector("#storage_cancel"),this.$storageInput=this._shadowRoot.querySelector("#se-storage-pref"),this.$rememberInput=this._shadowRoot.querySelector("#se-remember")}init(e){this.setAttribute("common-ok",e.t("common.ok")),this.setAttribute("common-cancel",e.t("common.cancel")),this.setAttribute("notify-editor_pref_msg",e.t("notification.editorPreferencesMsg")),this.setAttribute("properties-prefs_and_content",e.t("properties.prefs_and_content")),this.setAttribute("properties-prefs_only",e.t("properties.prefs_only")),this.setAttribute("properties-no_prefs_or_content",e.t("properties.no_prefs_or_content")),this.setAttribute("tools-remember_this_choice",e.t("tools.remember_this_choice")),this.setAttribute("tools-remember_this_choice_title",e.t("tools.remember_this_choice_title"))}static get observedAttributes(){return["dialog","storage","common-ok","common-cancel","notify-editor_pref_msg","properties-prefs_and_content","tools-remember_this_choice","tools-remember_this_choice_title","properties-prefs_only","properties-no_prefs_or_content"]}attributeChangedCallback(e,t,o){let i;switch(e){case"dialog":"open"===o?this.$dialog.open():this.$dialog.close();break;case"storage":this.$storageInput.options[0].disabled="true"!==o;break;case"common-ok":this.$okBtn.textContent=o;break;case"common-cancel":this.$cancelBtn.textContent=o;break;case"notify-editor_pref_msg":i=this._shadowRoot.querySelector("#notificationNote"),i.textContent=o;break;case"properties-prefs_and_content":i=this._shadowRoot.querySelector("#prefsAndContent"),i.textContent=o;break;case"properties-prefs_only":i=this._shadowRoot.querySelector("#prefsOnly"),i.textContent=o;break;case"properties-no_prefs_or_content":i=this._shadowRoot.querySelector("#noPrefsOrContent"),i.textContent=o;break;case"tools-remember_this_choice":i=this._shadowRoot.querySelector("#se-remember-title"),i.prepend(o);break;case"tools-remember_this_choice_title":i=this._shadowRoot.querySelector("#se-remember-title"),i.setAttribute("title",o)}}get dialog(){return this.getAttribute("dialog")}set dialog(e){this.setAttribute("dialog",e)}connectedCallback(){const e=(e,t)=>{const o=new CustomEvent("change",{detail:{trigger:t,select:this.$storageInput.value,checkbox:this.$rememberInput.checked}});this.dispatchEvent(o)};svgEditor.$click(this.$okBtn,(t=>e(0,"ok"))),svgEditor.$click(this.$cancelBtn,(t=>e(0,"cancel")))}}customElements.define("se-storage-dialog",n)}}]);
//# sourceMappingURL=499.d45bcacc.chunk.js.map